# FaceID
 얼굴인식 - 자신의 얼굴을 컴퓨터로 구별해 보세요

## Requirement 
 자신의 얼굴이 선명하게 나온 dataset
 사진에 나온 얼굴은 자신의 얼굴 하나만 있어야 해요

## Program Use
 FaceID.py를 실행시 콘솔창에 메세지가 출력됩니다.
 ![execution1] (./readme/execution1.png)

 1을 입력할 경우 웹캠에서 얼굴을 얻어와 같은 얼굴인지 판별을 진행합니다.
 ![execution2] (./readme/execution2.png)

 2를 입력할 경우 모델이 다시 학습을 진행합니다. 프로젝트 폴더의 images/0 폴더 안에 새로 학습을 진행할 얼굴 사진들을 넣어줍니다.
 폴더 내부의 사진들에 대해 얼굴을 찾고, 얼굴만 잘라 저장하는 전처리 과정을 거칩니다. 이 과정에서 얼굴이 너무 많이 발견되거나 발견되지 않은 사진들은
 프로그램이 자동으로 삭제합니다.

 이후 학습이 완료되면 다시 입력을 받는 과정으로 돌아갑니다.

 1 혹은 2가 아닌 입력이 주어질 경우 프로그램을 종료합니다.

## Program Explain
 vgg16 기반의 모델이 나의 사진을 학습합니다. vgg16의 Fully Connected Layer에서 나의 얼굴이 맞는지 아닌지로 구분하기 위해 출력층을 2개로 변경했습니다.
 전체 모델은 vgg16의 CNN네트워크에 FC-512, FC-512, FC-2 층으로 이어집니다.

 모델은 images폴더 안의 이미지들로 학습을 진행합니다. 0에는 자신의 얼굴을, 1에는 자신의 얼굴이 아닌 얼굴이 저장됩니다.

 학습에 사용된 이미지의 0 폴더에는 걸그룹 스테이씨의 ISA님 얼굴, 1 폴더에는 아이브의 LIZ, 스테이씨 수민과 Celeb Face dataset 일부를 사용했습니다.

 학습이 완료되면 웹캠을 통해 얻어진 얼굴이 학습된 얼굴과 동일한 얼굴인지 판별해 결과를 출력합니다

## Model Validation
 모델의 정확성을 테스트하기 위해, 학습에 사용된 이미지들을 그대로 테스트에 사용했습니다.
 Classifier.Classifier.evalueateModel()함수를 호출하면 모델의 accuracy, precision, recall값을 얻을 수 있습니다.
 
 ![cap] (./readme/validation.png)
 Accuracy 0.875이지만, images/0 폴더 안의 이미지가 1 폴더 안의 이미지보다 훨씬 많아 생기는 현상일 수 있습니다.
 더 정확한 분석을 위해 Precision과 Recall을 참고합니다. Precision의 값은 0.7656, Recall 0.8750로 Accuracy와 큰 차이를 보이지 않고 있습니다.
 
## Problem to Solve
 1. 자신의 사진이 많이 있어야만 모델의 정확도를 높힐 수 있다는 문제점이 있습니다.
 2. 현대의 얼굴인식 프로그램(Apple의 FaceID 등)은 얼굴 전체를 스캔해 학습합니다. 그러나 이 프로그램에서 사용한 모델은 얼굴이 정면으로 찍혀있어 얼굴이 인식되어야만 학습과 판별에 사용합니다. 따라서 정확도가 비교적 떨어집니다.

 더 적은 데이터셋으로도 정확도를 높히기 위해 Fully Connected layer를 더 추가해 보거나, 이미지의 특징점을 사용하여 모델에 넣어보기도 하였지만 판별에 필요한 시간이 기하급수적으로 늘어나는 문제가 발생했습니다.